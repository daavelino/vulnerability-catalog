#from django.forms import Form, ModelForm, Select, DateInput, FloatField, NumberInput, Textarea, CharField, FileField
from django import forms
from django.db import models

from catalog.models import Vulnerability, RiskQuestions

class DateInput(forms.DateInput):
    input_type = 'date'

class VulnerabilityForm(forms.ModelForm):
    class Meta:
        model = Vulnerability
        fields = '__all__'

        cvss_value = forms.FloatField(min_value=0, max_value=10)
        report_page = forms.FloatField(min_value=0)
        risk = forms.CharField(initial='Not evaluated')

        widgets = {
                'perimeter': forms.Select(),
                'synopsis': forms.Textarea(attrs={'cols':30,'rows':5,'wrap':'hard'}),
                'identification_date': DateInput(),
                'remediation_deadline': DateInput(),
                'remediation': forms.Textarea(attrs={'cols':30,'rows':5,'wrap':'hard'}),
                'observation': forms.Textarea(attrs={'cols':30,'rows':5,'wrap':'hard'}),
                'cvss_value': forms.NumberInput(attrs={'min':0, 'max':10}),
                'report_page': forms.NumberInput(attrs={'min':0})
            }
    

class FastUpdateForm(forms.ModelForm):
    class Meta:
        model = Vulnerability
        fields =[
            'status', 
            'risk', 
            'risk_vector', 
            'risk_acceptance_reason',
            'cvss_value', 
            'cvss_vector', 
            'remediation_deadline'
            ]

        widgets = {
                'remediation_deadline': DateInput()
            }

class UploadFileForm(forms.Form):
    title = forms.CharField(max_length=50)
    file = forms.FileField()
