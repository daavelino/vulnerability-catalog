from django.forms import Form, ModelForm, Select, DateInput, FloatField, NumberInput, Textarea, CharField, FileField
from django.db import models

from catalog.models import Vulnerability, RiskQuestions

class DateInput(DateInput):
    input_type = 'date'

class VulnerabilityForm(ModelForm):
    class Meta:
        model = Vulnerability
        fields = '__all__'

        cvss_value = FloatField(min_value=0, max_value=10)
        report_page = FloatField(min_value=0)

        widgets = {
                'perimeter': Select(),
                'synopsis': Textarea(attrs={'cols':30,'rows':5,'wrap':"hard"}),
                'identification_date': DateInput(),
                'remediation_deadline': DateInput(),
                'remediation': Textarea(attrs={'cols':30,'rows':5,'wrap':"hard"}),
                'observation': Textarea(attrs={'cols':30,'rows':5,'wrap':"hard"}),
                'cvss_value': NumberInput(attrs={'min':0, 'max':10}),
                'report_page': NumberInput(attrs={'min':0})
            }

class FastUpdateForm(ModelForm):
    class Meta:
        model = Vulnerability
        fields =['status', 'risk', 'remediation_deadline']

        widgets = {
                'remediation_deadline': DateInput()
            }

class UploadFileForm(Form):
    title = CharField(max_length=50)
    file = FileField()

class RiskQuestionsForm(ModelForm):
    class Meta:
        model = RiskQuestions
        fields = '__all__'

        widgets = {
            'position': NumberInput(attrs={'min':0}),
            'weight': NumberInput(attrs={'min':0, 'max':10}),
        }