from django.views.generic import TemplateView, ListView
from django.utils.decorators import method_decorator
from django.contrib.auth.decorators import login_required, permission_required

from .models import RiskQuestions

decorators = [login_required(login_url='catalog:login')]

#########################################################################
#### Read: requires catalog.read_vulnerability user permission.
#########################################################################

@method_decorator(decorators, name='dispatch')
@method_decorator(permission_required('catalog.read_vulnerability', \
    raise_exception=True), name='dispatch')
class CvssCalculatorView(TemplateView):
    template_name = 'catalog/cvss.html'

@method_decorator(decorators, name='dispatch')
@method_decorator(permission_required('catalog.read_vulnerability', \
    raise_exception=True), name='dispatch')
class RiskCalculatorView(ListView):
    model = RiskQuestions
    template_name = 'catalog/risk.html'

    def get_queryset(self):
        return RiskQuestions.objects.all()
