<!--add_custom_content.html-->
<div class="container">

  <div class="alert alert-success">
    <div class="row">
      <div class="col">
        <span class="h3">Add a vulnerability</span>
      </div>
      <div class="col">
          <small><span class="text-muted float-left">(or use our <a class="btn-outline-success" href="{% url 'catalog:massiveUpload' %}">massive upload</a> for multiple vulnerabilities.)</span></small>
      </div>
    </div>
  </div>

  <form method="post" action="">
    <div class="table-responsive">
      {% csrf_token %}
      <table class="table-sm">
        {{ form }}
      </table>
    </div>
    <input type="submit" class="btn btn-success createButton" value="Add" />
  </form>
</div>

<br class="clear">
<br class="clear">

<br class="clear">
<br class="clear">
<!-- Risk Calculator Modal -->
<div class="modal" id="riskCalculatorModal">
  <div class="modal-dialog">
    <div class="modal-content">  
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Risk Calculator</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
  
      <!-- Modal body -->
      <div class="modal-body">
        __RISK_CALCULATOR___
      </div>
  
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-primary" data-dismiss="modal">Done</button>
      </div>
  
    </div>
  </div>
</div>

<!-- CVSS Calculator Modal -->
<div class="modal" id="cvssCalculatorModal">
    <div class="modal-dialog">
      <div class="modal-content">  
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">CVSS 3.0 Calculator</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
    
        <!-- Modal body -->
        <div class="modal-body">
          __CVSS_CALCULATOR
        </div>
    
        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-primary" data-dismiss="modal" onclick="addRiskData()">Done</button>
        </div>
    
      </div>
    </div>
  </div>

  <script>
    function addRiskData() {
      var severity = document.getElementById("baseMetricScore");
      var cvssVector = location.hash;
      severity = severity.innerHTML;
      cvssVector = cvssVector.replace('#','');
      // Loading data in its corresponding forms:
      document.getElementById("id_cvss_value").value = severity;
      document.getElementById("id_cvss_vector").value = cvssVector;
    }
  </script>
<!--add_custom_content.html-->
