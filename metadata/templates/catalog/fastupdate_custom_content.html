<!--fastupdate_custom_content.html-->
<div class="container">

  <div class="alert alert-warning">
    <h3>Fast Update will only update the following fields:</h3>
  </div>
  
  <form method="post" action="">
    <div class="table-responsive">
      {% csrf_token %}
      <table class="table-sm">
        {{ form }}
      </table>
    </div>
    <input type="submit" class="btn btn-success updateButton" value="Fast update">
    </form>
</div>

<br class="clear">
  
<div class="container">
  <div class="table-responsive">
    <table class="table-sm table-bordered">
      <tr class="tr-faded">
        <th>Vulnerability ID:</th>
        <td>{{ vulnerability.id }}</td>
      </tr>
      <tr class="tr-faded-warning">
        <th>Status</th>
        <td>{{ vulnerability.status }}</td>
      </tr>
      <tr class="tr-faded-warning">
        <th>Risk</th>
        <td>{{ vulnerability.risk }}</td>
      </tr>
      <tr class="tr-faded-warning">
        <th>Risk Vector</th>
        <td>{{ vulnerability.risk_vector }}</td>
      </tr>
      <tr class="tr-faded-warning">
        <th>Risk Vector</th>
        <td>{{ vulnerability.risk_acceptance_reason }}</td>
      </tr>
      <tr class="tr-faded-warning">
        <th>Remediation deadline</th>
        <td>{{ vulnerability.remediation_deadline }}</td>
      </tr>
      <tr class="tr-faded">
        <th>Identification date</th>
        <td>{{ vulnerability.identification_date }}</td>
      </tr>
      <tr class="tr-faded">
        <th>System</th>
        <td>{{ vulnerability.system }}</td>
      </tr>
      <tr class="tr-faded-warning">
        <th>Cvss score</th>
        <td>{{ vulnerability.cvss_score }}</td>
      </tr>
      <tr class="tr-faded-warning">
        <th>Cvss Vector</th>
        <td>{{ vulnerability.cvss_vector }}</td>
      </tr>
      <tr class="tr-faded">
        <th>Vulnerability</th>
        <td>{{ vulnerability.vulnerability }}</td>
      </tr>
      <tr class="tr-faded">
        <th>Synopsis</th>
        <td>{{ vulnerability.synopsis }}</td>
      <tr class="tr-faded">
        <th>Remediation deadline</th>
        <td>{{ vulnerability.remediation_deadline }}</td>
      </tr>
      <tr class="tr-faded">
        <th>Owner</th>
        <td>{{ vulnerability.owner }}</td>
      </tr>
      <tr class="tr-faded">
       <th>Environment</th>
        <td>{{ vulnerability.environment }}</td>
      </tr>
      <tr class="tr-faded">
        <th>Perimeter</th>
        <td>{{ vulnerability.perimeter }}</td>
      </tr>
      <tr class="tr-faded">
        <th>Technology</th>
        <td>{{ vulnerability.technology }}</td>
      </tr>
      <tr class="tr-faded">
        <th>System type</th>
        <td>{{ vulnerability.system_type }}</td>
      </tr>
      <tr class="tr-faded">
        <th>Category</th>
        <td>{{ vulnerability.category }}</td>
      </tr>
    </table>
  </div>
</div>

<br class="clear">
<br class="clear">

<!-- Risk Calculator Modal -->
<div class="modal" id="riskCalculatorModal">
  <div class="modal-dialog">
    <div class="modal-content">  
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Risk Calculator</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
  
      <!-- Modal body -->
      <div class="modal-body">
        __RISK_CALCULATOR__
      </div>
  
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-primary" data-dismiss="modal" onclick="addRiskData()">Done</button>
      </div>
  
    </div>
  </div>
</div>
<!-- End Risk Calculator Modal -->
<!-- CVSS Calculator Modal -->
<div class="modal" id="cvssCalculatorModal">
    <div class="modal-dialog">
      <div class="modal-content">  
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">CVSS 3.0 Calculator</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
    
        <!-- Modal body -->
        <div class="modal-body">
          __CVSS_CALCULATOR__
        </div>
    
        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-primary" data-dismiss="modal" onclick="addCVSSData()">Done</button>
        </div>
    
      </div>
    </div>
  </div>
  <!-- End CVSS Calculator Modal -->
  <script>
    function addCVSSData() {
      var severity = document.getElementById("baseMetricScore");
      var cvssVector = location.hash;
      severity = severity.innerHTML;
      cvssVector = cvssVector.replace('#','');
      // Loading data in its corresponding forms:
      document.getElementById("id_cvss_value").value = severity;
      document.getElementById("id_cvss_vector").value = cvssVector;
    }
    function addRiskData() {
      var riskLevel = document.getElementById("riskLevel");
      var riskVector = document.getElementById("riskVectorValue");
      riskLevel = riskLevel.innerHTML;
      riskVector = riskVector.innerHTML;
      // Loading data in its corresponding forms:
      document.getElementById("id_risk").value = riskLevel;
      document.getElementById("id_risk_vector").value = riskVector;
    }
    </script>
<!--fastupdate_custom_content.html-->