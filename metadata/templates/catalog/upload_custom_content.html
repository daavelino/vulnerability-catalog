<!-- upload_custom_content.html -->

<div class="container">
  <h4>Massive upload</h4>
  <br class="clear">
  <form method="post" enctype="multipart/form-data" action="{% url 'catalog:getUploadFile' %}">
    <div class="custom-file">
      {% csrf_token %}
      <label class="custom-file-label" for="customFile">Choose file</label>
      <br class="clear">
      <input type="file" class="custom-file-input" id="uploadFileForm" name="uploadedFile">
    </div>
    <br class="clear">
    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
</div>
<br class="clear">
<br class="clear">

{% if savepoint %}
<div class="container">
  <form method="post" action="{% url 'catalog:deleteByList' %}">
  {% csrf_token %}
    <div class="alert alert-success" role="alert">
      <strong>Success!</strong><span> Data uploaded successfuly. But, if you wish you can rollback this transaction: </span>
      <input type="hidden" id="deleteList" name="deleteList" value="{{ savepoint }}">
      <button type="submit" class="btn btn-outline-secondary btn-sm">Rollback</button>
  </div>
</form>
</div>
{% endif %}

{% if uploaderror %}
  {% if uploaderror == True %}
  <div class="container">
    <div class="alert alert-warning alert-dismissible fade show" role="alert">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <strong>Error.</strong> File <strong>could</strong> not be uploaded. Please, check its syntax.
    </div>
  </div>
  {% endif %}        
{% endif %} 

{% if not savepoint %}
<div class="container">
  <div class="alert alert-info" role="alert">
    <strong>Notice:</strong> Upload JSON files according to the following <strong>examples</strong>:
    <button class="btn btn-outline-secondary" type="button" data-toggle="collapse" data-target="#collapseMinimal" aria-expanded="false" aria-controls="collapseExample">
      Minimal
    </button>
    <button class="btn btn-outline-secondary" type="button" data-toggle="collapse" data-target="#collapseComplete" aria-expanded="false" aria-controls="collapseExample">
      Complete
    </button>
    <button class="btn btn-outline-secondary" type="button" data-toggle="collapse" data-target="#collapseCombined" aria-expanded="false" aria-controls="collapseExample">
      Combined
    </button>
  </div>
  <div class="collapse" id="collapseMinimal">
    <div class="card card-block bg-faded">
<pre>
[ 
  {
    "model": "catalog.vulnerability",
    "fields": {
    "system": "Web Supply",
    "owner": "Niels Bohr",
    "owner_email": "bohr@copenhagen.com",
    "environment": "Cloud",
    "perimeter": "External",
    "technology": "ASPX",
    "system_type": "Application",
    "vulnerability": "File structure exposed",
    "synopsis": "/wp-includes exposed.",
    "cvss_value": 4,
    "identification_date": "2018-01-28",
    "remediation_deadline": "2018-02-28",
    "status": "Notified"
    }
  }
]
</pre>
    </div>
  </div>
  <div class="collapse" id="collapseComplete">
    <div class="card card-block bg-faded">
<pre>
[
  {
    "model": "catalog.vulnerability",
    "fields": {
    "system": "Sharepoint Interno",
    "owner": "Niels Bohr",
    "owner_email": "bohr@copenhagen.com",
    "environment": "Data Center",
    "perimeter": "Internal",
    "technology": "Sharepoint Microsoft",
    "system_type": "Application",
    "vulnerability": "Sensitive data exposure",
    "category": "Unprotected Comunication",
    "synopsis": "Authentication tokens transported without criptographic protection.",
    "cvss_value": 8,
    "identification_date": "2018-01-28",
    "reporter": "Consulting",
    "risk": "Medium",
    "observation": "User's credentials are sent in plaintext (without cryptographic protection) to the applications.",
    "remediation": "Server was configured to use TLS in all its communications.",
    "risk_acceptance_reason": "",
    "remediation_deadline": "2018-02-28",
    "status": "Notified",
    "report_file": "Consulting - 28.01.2018 - External Test Report - V.1.0.docx",
    "report_page": 19
    }
  }
]
</pre>
    </div>  
  </div>
  <div class="collapse" id="collapseCombined">
    <div class="card card-block bg-faded">
<pre>
[
  {
    "model": "catalog.vulnerability",
    "fields": {
    "system": "Web Supply",
    "owner": "Niels Bohr",
    "owner_email": "bohr@copenhagen.com",
    "environment": "Cloud",
    "perimeter": "External",
    "technology": "ASPX",
    "system_type": "Application",
    "vulnerability": "File structure exposed",
    "synopsis": "/wp-includes exposed.",
    "cvss_value": 4,
    "identification_date": "2018-01-28",
    "remediation_deadline": "2018-02-28",
    "status": "Notified"
    }
  },
  {
    "model": "catalog.vulnerability",
    "fields": {
    "system": "Sharepoint Interno",
    "owner": "Niels Bohr",
    "owner_email": "bohr@copenhagen.com",
    "environment": "Data Center",
    "perimeter": "Internal",
    "technology": "Sharepoint Microsoft",
    "system_type": "Application",
    "vulnerability": "Sensitive data exposure",
    "category": "Unprotected Comunication",
    "synopsis": "Authentication tokens transported without criptographic protection.",
    "cvss_value": 8,
    "identification_date": "2018-01-28",
    "reporter": "Consulting",
    "risk": "Medium",
    "observation": "User's credentials are sent in plaintext (without cryptographic protection) to the applications.",
    "remediation": "Server was configured to use TLS in all its communications.",
    "risk_acceptance_reason": "",
    "remediation_deadline": "2018-02-28",
    "status": "Notified",
    "report_file": "Consulting - 28.01.2018 - External Test Report - V.1.0.docx",
    "report_page": 19
    }
  }
]
</pre>
    </div>
  </div>
{% endif %}
     
  <br class="clear">
  <br class="clear">
</div>

<script>
  function loadPreviewSelect() {
    /* In the future, it will create the select html elements. */
    return null;
  }
</script>
<!-- upload_custom_content.html -->